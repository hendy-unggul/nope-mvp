<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NOPE ‚Äî JURNAL</title>
  
  <meta name="theme-color" content="#0a0a0a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700;800&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    :root {
      --bg: #0A0A0A;
      --surface: #151A21;
      --border: #222222;
      --text: #E9EEF5;
      --muted: #8A8A8A;
      --accent: #00FF88;
      --accent-glow: rgba(0, 255, 136, 0.3);
      --electric: #40E0FF;
      --fire: #FF6A3D;
    }
    
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Inter', sans-serif;
      font-size: 15px;
      line-height: 1.6;
      padding-bottom: 100px;
      -webkit-font-smoothing: antialiased;
    }
    
    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.98);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      z-index: 100;
    }
    
    .header-content {
      max-width: 480px;
      margin: 0 auto;
      padding: 12px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .logo-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .logo {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 28px;
      font-weight: 800;
      color: white;
      text-decoration: none;
      transform: skew(-4deg);
      text-shadow: 3px 3px 0 var(--accent);
      letter-spacing: -1px;
    }
    
    .badge {
      background: var(--accent);
      color: black;
      font-size: 10px;
      font-weight: 700;
      padding: 2px 6px;
      border-radius: 4px;
      transform: skew(4deg);
      font-family: 'Space Grotesk', sans-serif;
    }
    
    .header-actions {
      display: flex;
      gap: 8px;
    }
    
    .btn {
      border: none;
      border-radius: 8px;
      padding: 8px 14px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
      font-family: 'Inter', sans-serif;
    }
    
    .btn-secondary {
      background: var(--surface);
      color: var(--muted);
      border: 1px solid var(--border);
    }
    
    .btn-secondary:hover {
      border-color: var(--accent);
      color: white;
      transform: translateY(-1px);
    }
    
    .btn-primary {
      background: var(--accent);
      color: black;
      box-shadow: 0 4px 15px var(--accent-glow);
    }
    
    .btn-primary:hover {
      transform: scale(1.05) translateY(-2px);
      box-shadow: 0 8px 25px var(--accent-glow);
    }
    
    .btn-primary:active {
      transform: scale(0.98);
    }
    
    /* Marquee */
    .marquee-wrap {
      background: rgba(0, 255, 136, 0.05);
      border-bottom: 1px solid rgba(0, 255, 136, 0.1);
      overflow: hidden;
      padding: 6px 0;
    }
    
    .marquee {
      display: flex;
      animation: scroll 20s linear infinite;
      white-space: nowrap;
    }
    
    .marquee-item {
      font-family: 'Space Grotesk', monospace;
      font-size: 11px;
      color: var(--accent);
      padding: 0 20px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    @keyframes scroll {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }
    
    /* Navigation Tabs */
    .nav-tabs {
      max-width: 480px;
      margin: 0 auto;
      padding: 12px 16px;
      display: flex;
      gap: 4px;
      overflow-x: auto;
      scrollbar-width: none;
    }
    
    .nav-tabs::-webkit-scrollbar {
      display: none;
    }
    
    .nav-tab {
      padding: 6px 12px;
      font-size: 12px;
      color: var(--muted);
      text-decoration: none;
      border-radius: 6px;
      transition: all 0.2s;
      white-space: nowrap;
      font-weight: 500;
      border: 1px solid transparent;
    }
    
    .nav-tab:hover {
      color: white;
      background: rgba(255, 255, 255, 0.05);
    }
    
    .nav-tab.active {
      color: var(--accent);
      background: rgba(0, 255, 136, 0.1);
      border-color: rgba(0, 255, 136, 0.3);
    }
    
    /* Main Content */
    .container {
      max-width: 480px;
      margin: 0 auto;
      padding: 140px 16px 24px;
    }
    
    /* Hero Image */
    .hero {
      position: relative;
      width: 100%;
      aspect-ratio: 4/5;
      background: var(--surface);
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid var(--border);
      margin-bottom: 16px;
      transition: all 0.3s;
    }
    
    .hero:hover {
      border-color: var(--accent);
      box-shadow: 0 0 30px var(--accent-glow);
    }
    
    .hero img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    
    .hero-notation {
      position: absolute;
      top: 16px;
      left: 16px;
      right: 16px;
      font-family: 'Space Grotesk', sans-serif;
      font-size: 24px;
      font-weight: 700;
      color: white;
      text-shadow: 2px 2px 0 black, -1px -1px 0 var(--accent);
      line-height: 1.2;
      word-wrap: break-word;
    }
    
    .corner {
      position: absolute;
      width: 20px;
      height: 20px;
      border-color: var(--accent);
      border-style: solid;
      pointer-events: none;
    }
    
    .corner-tl { top: 8px; left: 8px; border-width: 2px 0 0 2px; }
    .corner-tr { top: 8px; right: 8px; border-width: 2px 2px 0 0; }
    .corner-bl { bottom: 8px; left: 8px; border-width: 0 0 2px 2px; }
    .corner-br { bottom: 8px; right: 8px; border-width: 0 2px 2px 0; }
    
    .upload-btn {
      position: absolute;
      bottom: 16px;
      right: 16px;
      background: var(--accent);
      color: black;
      border: 2px solid black;
      padding: 8px 16px;
      border-radius: 8px;
      font-weight: 700;
      font-size: 13px;
      cursor: pointer;
      box-shadow: 3px 3px 0 black;
      transition: all 0.2s;
    }
    
    .upload-btn:hover {
      transform: translate(-2px, -2px);
      box-shadow: 5px 5px 0 black;
    }
    
    .upload-btn:active {
      transform: translate(0, 0);
      box-shadow: 1px 1px 0 black;
    }
    
    /* Post Upload Panel */
    .upload-panel {
      background: var(--surface);
      border: 2px solid var(--accent);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 4px 4px 0 rgba(0, 255, 136, 0.2);
      display: none;
    }
    
    .upload-panel.show {
      display: block;
      animation: slideDown 0.3s ease;
    }
    
    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .panel-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
      font-size: 11px;
      color: var(--accent);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .dot {
      width: 8px;
      height: 8px;
      background: var(--accent);
      border-radius: 50%;
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    .input-group {
      display: flex;
      gap: 8px;
    }
    
    .input {
      flex: 1;
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px 14px;
      color: white;
      font-size: 14px;
      font-family: 'Inter', sans-serif;
    }
    
    .input:focus {
      outline: none;
      border-color: var(--accent);
    }
    
    .suggestions {
      display: flex;
      gap: 8px;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    
    .suggestion {
      font-size: 12px;
      color: var(--accent);
      cursor: pointer;
      text-decoration: underline;
      text-decoration-style: dotted;
    }
    
    .suggestion:hover {
      color: white;
    }
    
    /* Rant Box */
    .rant-box {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 16px;
      transition: all 0.3s;
    }
    
    .rant-box:focus-within {
      border-color: var(--accent);
      box-shadow: 0 0 20px var(--accent-glow);
    }
    
    .rant-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .avatar {
      width: 36px;
      height: 36px;
      background: linear-gradient(135deg, var(--accent), var(--electric));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      border: 2px solid black;
      box-shadow: 2px 2px 0 var(--accent);
    }
    
    .username {
      font-weight: 700;
      font-size: 14px;
    }
    
    .online-status {
      font-size: 10px;
      color: var(--accent);
      font-family: 'Space Grotesk', monospace;
    }
    
    .char-count {
      font-size: 12px;
      color: var(--muted);
      font-family: 'Space Grotesk', monospace;
      background: rgba(0, 0, 0, 0.3);
      padding: 4px 8px;
      border-radius: 4px;
    }
    
    textarea {
      width: 100%;
      background: transparent;
      border: none;
      color: white;
      font-size: 15px;
      line-height: 1.6;
      resize: none;
      min-height: 100px;
      font-family: 'Inter', sans-serif;
    }
    
    textarea:focus {
      outline: none;
    }
    
    textarea::placeholder {
      color: var(--muted);
    }
    
    .intensity-wrap {
      margin: 16px 0;
    }
    
    .intensity-label {
      display: flex;
      justify-content: space-between;
      font-size: 10px;
      color: var(--muted);
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .intensity-bar {
      height: 4px;
      background: var(--border);
      border-radius: 2px;
      overflow: hidden;
    }
    
    .intensity-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--accent), var(--electric));
      transition: all 0.3s;
      border-radius: 2px;
    }
    
    .rant-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 16px;
      border-top: 1px solid var(--border);
    }
    
    .emoji-actions {
      display: flex;
      gap: 12px;
    }
    
    .emoji-btn {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      opacity: 0.6;
      transition: all 0.2s;
    }
    
    .emoji-btn:hover {
      opacity: 1;
      transform: scale(1.2);
    }
    
    /* Diary Section */
    .section {
      margin-bottom: 24px;
    }
    
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    
    .section-title {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 18px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .section-link {
      font-size: 11px;
      color: var(--muted);
      text-decoration: none;
      font-family: 'Space Grotesk', monospace;
    }
    
    .section-link:hover {
      color: var(--accent);
    }
    
    .entry {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 12px;
      transition: all 0.2s;
    }
    
    .entry:hover {
      border-color: rgba(0, 255, 136, 0.3);
      transform: translateX(4px);
    }
    
    .entry-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .entry-author {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .entry-avatar {
      width: 28px;
      height: 28px;
      background: linear-gradient(135deg, var(--fire), orange);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 700;
    }
    
    .entry-name {
      font-weight: 600;
      font-size: 13px;
    }
    
    .entry-badge {
      font-size: 9px;
      background: rgba(0, 255, 136, 0.15);
      color: var(--accent);
      padding: 2px 6px;
      border-radius: 4px;
      font-weight: 600;
    }
    
    .entry-time {
      font-size: 11px;
      color: var(--muted);
      font-family: 'Space Grotesk', monospace;
    }
    
    .entry-content {
      font-size: 14px;
      line-height: 1.6;
      color: #e0e0e0;
      margin-bottom: 12px;
    }
    
    .entry-actions {
      display: flex;
      gap: 16px;
      padding-top: 12px;
      border-top: 1px solid var(--border);
    }
    
    .reaction {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
      color: var(--muted);
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .reaction:hover {
      color: var(--accent);
      transform: scale(1.1);
    }
    
    .reaction span:first-child {
      font-size: 16px;
    }
    
    /* Tray Grid */
    .tray {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    
    .tray-item {
      aspect-ratio: 1;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      position: relative;
      transition: all 0.2s;
    }
    
    .tray-item:hover {
      border-color: var(--accent);
      transform: scale(1.05);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    }
    
    .tray-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .tray-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
      opacity: 0;
      transition: opacity 0.2s;
      display: flex;
      align-items: flex-end;
      padding: 8px;
    }
    
    .tray-item:hover .tray-overlay {
      opacity: 1;
    }
    
    .tray-text {
      font-size: 10px;
      color: white;
      font-weight: 600;
      line-height: 1.2;
    }
    
    .tray-dummy {
      opacity: 0.6;
    }
    
    /* Toast */
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--accent);
      color: black;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 700;
      font-size: 14px;
      opacity: 0;
      transition: all 0.3s;
      z-index: 1000;
      box-shadow: 0 4px 20px var(--accent-glow);
    }
    
    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    
    /* Footer */
    .footer {
      text-align: center;
      padding: 40px 20px;
    }
    
    .footer-text {
      display: inline-block;
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 8px 20px;
      font-size: 11px;
      color: var(--muted);
      font-family: 'Space Grotesk', monospace;
      letter-spacing: 2px;
      text-transform: uppercase;
    }
    
    /* FAB */
    .fab {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
      background: var(--accent);
      border: 2px solid black;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 4px 4px 0 black;
      transition: all 0.2s;
      z-index: 99;
    }
    
    .fab:hover {
      transform: translate(-2px, -2px);
      box-shadow: 6px 6px 0 black;
    }
    
    .fab:active {
      transform: translate(0, 0);
      box-shadow: 2px 2px 0 black;
    }
    
    @media (min-width: 768px) {
      .fab {
        display: none;
      }
    }
  </style>
</head>
<body>

  <header class="header">
    <div class="header-content">
      <div class="logo-group">
        <a href="index.html" class="logo">NOPE</a>
        <span class="badge">JURNAL</span>
      </div>
      <div class="header-actions">
        <button class="btn btn-secondary" onclick="location.href='frekuensi-zones.html'">‚ö° Zones</button>
        <button class="btn btn-primary" onclick="showToast('Tersimpan!')">üíæ Save</button>
      </div>
    </div>
    
    <div class="marquee-wrap">
      <div class="marquee">
        <span class="marquee-item">üî• STREAK HARI INI: 5</span>
        <span class="marquee-item">üò§ EMOSI TERBANYAK: CEMBURU</span>
        <span class="marquee-item">üí¨ 128 PESAN BARU</span>
        <span class="marquee-item">üë• 47 ORANG LAGI NYAMBAT</span>
        <span class="marquee-item">‚ö° MATCH STREAK: 3 DAYS</span>
        <span class="marquee-item">üî• STREAK HARI INI: 5</span>
        <span class="marquee-item">üò§ EMOSI TERBANYAK: CEMBURU</span>
        <span class="marquee-item">üí¨ 128 PESAN BARU</span>
        <span class="marquee-item">üë• 47 ORANG LAGI NYAMBAT</span>
        <span class="marquee-item">‚ö° MATCH STREAK: 3 DAYS</span>
      </div>
    </div>
    
    <nav class="nav-tabs">
      <a href="jejak.html" class="nav-tab active">üìì Jurnal</a>
      <a href="frekuensi-zones.html" class="nav-tab">‚ö° Frekuensi</a>
      <a href="saynope.html" class="nav-tab">üö´ SayNOPE</a>
      <a href="glitch.html" class="nav-tab">üëæ Glitch</a>
    </nav>
  </header>

  <main class="container">
    <!-- Hero Image -->
    <div class="hero" id="hero">
      <img id="hero-img" src="https://picsum.photos/seed/nope-hero/800/1000" alt="artefak">
      <div class="hero-notation" id="hero-notation-display">KADANG HIDUP ABU ABU</div>
      <div class="corner corner-tl"></div>
      <div class="corner corner-tr"></div>
      <div class="corner corner-bl"></div>
      <div class="corner corner-br"></div>
      <button class="upload-btn" onclick="document.getElementById('file-input').click()">
        üì§ Unggah
      </button>
    </div>

    <!-- Upload Panel -->
    <div class="upload-panel" id="upload-panel">
      <div class="panel-header">
        <div class="dot"></div>
        TAMBAHKAN NOTASI (MAKS 4 KATA)
      </div>
      <div class="input-group">
        <input type="text" class="input" id="notation-input" placeholder="contoh: capek banget" maxlength="50">
        <button class="btn btn-primary" onclick="saveNotation()">Simpan</button>
      </div>
      <div class="suggestions">
        <span class="suggestion" onclick="setNotation('gak tau lagi')">gak tau lagi</span>
        <span class="suggestion" onclick="setNotation('biasa aja')">biasa aja</span>
        <span class="suggestion" onclick="setNotation('pengen sendiri')">pengen sendiri</span>
        <span class="suggestion" onclick="setNotation('capek')">capek</span>
      </div>
    </div>

    <!-- Rant Box -->
    <div class="rant-box">
      <div class="rant-header">
        <div class="user-info">
          <div class="avatar">üë§</div>
          <div>
            <div class="username" id="username-display">@newglitch</div>
            <div class="online-status">‚óè ONLINE NOW</div>
          </div>
        </div>
        <div class="char-count">
          <span id="char-count">0</span>/300
        </div>
      </div>
      
      <textarea id="rant-input" placeholder="marah? sedih? cape? tulis aja. gak usah bener. gak usah rapi. ini tempat sampah emosimu." maxlength="300"></textarea>
      
      <div class="intensity-wrap">
        <div class="intensity-label">
          <span>Intensitas Emosi</span>
          <span id="intensity-text">NETRAL</span>
        </div>
        <div class="intensity-bar">
          <div class="intensity-fill" id="intensity-fill"></div>
        </div>
      </div>
      
      <div class="rant-footer">
        <div class="emoji-actions">
          <button class="emoji-btn" onclick="addEmoji('üò§')">üò§</button>
          <button class="emoji-btn" onclick="addEmoji('üò¢')">üò¢</button>
          <button class="emoji-btn" onclick="addEmoji('üò¥')">üò¥</button>
          <button class="emoji-btn" onclick="addEmoji('üî•')">üî•</button>
        </div>
        <button class="btn btn-primary" onclick="postRant()">Unggah ‚Üí</button>
      </div>
    </div>

    <!-- Diary Section -->
    <section class="section">
      <div class="section-header">
        <h2 class="section-title">üìì JEJAK</h2>
        <a href="#" class="section-link">[LIHAT SEMUA]</a>
      </div>
      <div id="diary-entries">
        <!-- Entries injected by JS -->
      </div>
    </section>

    <!-- Artefak Tray -->
    <section class="section">
      <div class="section-header">
        <h2 class="section-title">üéûÔ∏è ARTEFAK</h2>
        <span style="font-size: 12px; color: var(--muted); font-family: 'Space Grotesk', monospace;">6 total</span>
      </div>
      <div class="tray" id="tray">
        <!-- Tray items injected by JS -->
      </div>
    </section>

    <footer class="footer">
      <div class="footer-text">Nyambat ‚Ä¢ Aksi ‚Ä¢ Solusi</div>
    </footer>
  </main>

  <!-- Toast -->
  <div class="toast" id="toast">Tersimpan!</div>

  <!-- FAB -->
  <button class="fab" onclick="document.getElementById('rant-input').focus()">+</button>

  <!-- Hidden File Input -->
  <input type="file" id="file-input" accept="image/*" style="display: none;" onchange="handleFileSelect(event)">

  <script>
    // Data
    const currentUser = localStorage.getItem('nope_username') || '@newglitch';
    document.getElementById('username-display').textContent = currentUser;
    
    let artefacts = [];
    let rants = [];
    
    const dummyRants = [
      {
        id: 1,
        username: 'homie1',
        content: "gue udah bantuin dia tiap malem pas dia galau sampe gue lupa ngerjain tugas sendiri. pas gue butuh temen buat ngobrol, dia malah offline terus. gak minta balasan sih, tapi rasanya kayak jadi tempat sampah emosi doang.",
        time: '2 jam lalu',
        reactions: { 'ü§†': 3, 'üò¢': 12, 'ü§ó': 2, 'üî•': 5 }
      },
      {
        id: 2,
        username: 'homie2',
        content: "deadline mepet, dosen gak jelas, dompet kering. rasanya pengen ijin cuti sehari buat jadi batu aja.",
        time: '5 jam lalu',
        reactions: { 'ü§†': 1, 'üò¢': 8, 'ü§ó': 5, 'üî•': 2 }
      },
      {
        id: 3,
        username: 'homie3',
        content: "capek.",
        time: '1 hari lalu',
        reactions: { 'ü§†': 0, 'üò¢': 15, 'ü§ó': 3, 'üî•': 1 }
      }
    ];
    
    const dummyArtefacts = [
      { id: 1, url: 'https://picsum.photos/seed/nope1/400/400', text: 'kadang hidup abu abu' },
      { id: 2, url: 'https://picsum.photos/seed/nope2/400/400', text: 'gebetan temen' },
      { id: 3, url: 'https://picsum.photos/seed/nope3/400/400', text: 'gabut no face' },
      { id: 4, url: 'https://picsum.photos/seed/nope4/400/400', text: 'lonelyness' },
      { id: 5, url: 'https://picsum.photos/seed/nope5/400/400', text: 'capek' },
      { id: 6, url: 'https://picsum.photos/seed/nope6/400/400', text: 'love it' }
    ];
    
    // Functions
    function showToast(msg) {
      const toast = document.getElementById('toast');
      toast.textContent = msg;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2000);
    }
    
    function setNotation(text) {
      document.getElementById('notation-input').value = text;
    }
    
    function saveNotation() {
      const val = document.getElementById('notation-input').value.trim();
      if (!val) {
        showToast('Tulis dulu!');
        return;
      }
      const words = val.split(/\s+/).filter(w => w);
      if (words.length > 4) {
        showToast('Maks 4 kata!');
        return;
      }
      document.getElementById('hero-notation-display').textContent = val.toUpperCase();
      document.getElementById('upload-panel').classList.remove('show');
      showToast('Notasi tersimpan!');
    }
    
    function handleFileSelect(e) {
      const file = e.target.files[0];
      if (!file) return;
      if (!file.type.startsWith('image/')) {
        showToast('Hanya gambar!');
        return;
      }
      
      const reader = new FileReader();
      reader.onload = (event) => {
        document.getElementById('hero-img').src = event.target.result;
        document.getElementById('upload-panel').classList.add('show');
        document.getElementById('notation-input').value = '';
        document.getElementById('notation-input').focus();
      };
      reader.readAsDataURL(file);
    }
    
    function addEmoji(emoji) {
      const textarea = document.getElementById('rant-input');
      textarea.value += emoji;
      updateIntensity();
      textarea.focus();
    }
    
    function updateIntensity() {
      const text = document.getElementById('rant-input').value;
      const len = text.length;
      const percentage = (len / 300) * 100;
      
      document.getElementById('char-count').textContent = len;
      document.getElementById('intensity-fill').style.width = percentage + '%';
      
      const label = document.getElementById('intensity-text');
      if (percentage < 20) {
        label.textContent = 'NETRAL';
        label.style.color = '#8A8A8A';
      } else if (percentage < 50) {
        label.textContent = 'GANGGUAN';
        label.style.color = '#40E0FF';
      } else if (percentage < 80) {
        label.textContent = 'CHAOS';
        label.style.color = '#00FF88';
      } else {
        label.textContent = 'BURNING';
        label.style.color = '#FF6A3D';
      }
    }
    
    function postRant() {
      const content = document.getElementById('rant-input').value.trim();
      if (!content) {
        showToast('Tulis dulu!');
        return;
      }
      
      const newEntry = {
        id: Date.now(),
        username: currentUser.replace('@', ''),
        content: content,
        time: 'baru saja',
        reactions: { 'ü§†': 0, 'üò¢': 0, 'ü§ó': 0, 'üî•': 0 },
        isNew: true
      };
      
      rants.unshift(newEntry);
      renderDiary();
      document.getElementById('rant-input').value = '';
      updateIntensity();
      showToast('Terkirim!');
    }
    
    function renderDiary() {
      const container = document.getElementById('diary-entries');
      const entries = rants.length > 0 ? rants : dummyRants;
      
      container.innerHTML = entries.map(entry => `
        <div class="entry ${entry.isNew ? 'glow-hover' : ''}">
          <div class="entry-header">
            <div class="entry-author">
              <div class="entry-avatar">${entry.username.charAt(0).toUpperCase()}</div>
              <div>
                <span class="entry-name">@${entry.username}</span>
                ${entry.isNew ? '<span class="entry-badge">KAMU</span>' : ''}
              </div>
            </div>
            <span class="entry-time">${entry.time}</span>
          </div>
          <div class="entry-content">${entry.content}</div>
          <div class="entry-actions">
            ${Object.entries(entry.reactions).map(([emoji, count]) => `
              <div class="reaction" onclick="incrementReaction(this)">
                <span>${emoji}</span>
                <span class="count">${count}</span>
              </div>
            `).join('')}
          </div>
        </div>
      `).join('');
    }
    
    function incrementReaction(el) {
      const countSpan = el.querySelector('.count');
      countSpan.textContent = parseInt(countSpan.textContent) + 1;
      el.style.color = '#00FF88';
    }
    
    function renderTray() {
      const tray = document.getElementById('tray');
      const items = artefacts.length > 0 ? artefacts : dummyArtefacts;
      
      tray.innerHTML = items.map((item, idx) => `
        <div class="tray-item ${!artefacts.length ? 'tray-dummy' : ''}" onclick="setHeroImage('${item.url}', '${item.text}')">
          <img src="${item.url}" alt="" loading="lazy">
          <div class="tray-overlay">
            <div class="tray-text">${item.text || ''}</div>
          </div>
        </div>
      `).join('');
    }
    
    function setHeroImage(url, text) {
      document.getElementById('hero-img').src = url;
      document.getElementById('hero-notation-display').textContent = (text || '').toUpperCase();
    }
    
    // Event Listeners
    document.getElementById('rant-input').addEventListener('input', updateIntensity);
    
    // Initialize
    renderDiary();
    renderTray();
  </script>
</body>
</html>
