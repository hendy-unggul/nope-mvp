<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<title>Spill ‚Äî JEJAK</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#000;
  --sf:#0a0a0a;
  --sfe:#111;
  --bd:#1a1a1a;
  --tx:#fff;
  --txs:#666;
  --txm:#444;
  --ap:#ff3d00;
  --as:#00f0ff;
  --aq:#00ff41;
  --war:#ff0040;
  --safe-bottom:env(safe-area-inset-bottom);
  --safe-top:env(safe-area-inset-top)
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}
html{height:100%;overflow:hidden}
body{
  height:100%;
  background:var(--bg);
  color:var(--tx);
  font-family:'Inter',-apple-system,sans-serif;
  font-size:14px;
  line-height:1.4;
  overflow:hidden;
  position:fixed;
  width:100%;
  overscroll-behavior:none
}
.app{height:100%;display:flex;flex-direction:column;overflow:hidden}

/* HEADER */
.header{
  padding:12px 16px calc(8px + var(--safe-top));
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:1px solid var(--bd);
  background:var(--bg);
  flex-shrink:0
}
.logo{font-size:28px;font-weight:800;letter-spacing:-2px;line-height:1}
.logo span{color:var(--ap)}
.status{display:flex;align-items:center;gap:6px}
.pulse{width:6px;height:6px;background:var(--aq);border-radius:50%;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
.live{font-size:10px;font-weight:600;color:var(--txs);letter-spacing:.5px}

/* SCROLL AREA */
.scroll{flex:1;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;overscroll-behavior-y:contain}
.scroll::-webkit-scrollbar{display:none}

/* RADAR - NATIVE MOBILE OPTIMIZED */
.radar-sect{
  position:relative;
  background:var(--sf);
  border-bottom:1px solid var(--bd);
  padding:12px 0
}
.radar-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:0 16px 12px
}
.radar-label{font-family:'Space Mono',monospace;font-size:9px;color:var(--aq);letter-spacing:1px;display:flex;align-items:center;gap:6px}
.radar-label::before{content:'';width:6px;height:6px;background:var(--aq);border-radius:50%;animation:blink 1s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}
.radar-stat{font-family:'Space Mono',monospace;font-size:9px;color:var(--txs)}
.radar-wrapper{
  position:relative;
  width:100%;
  padding:0 16px
}
.radar-cont{
  position:relative;
  width:100%;
  height:calc(100vw - 32px);
  max-height:380px;
  background:radial-gradient(circle at center,#0a1a0a 0%,#000 70%);
  border-radius:12px;
  overflow:hidden;
  border:1px solid var(--bd)
}
.radar-grid{
  position:absolute;
  inset:0;
  opacity:.08;
  background-image:
    repeating-linear-gradient(0deg,rgba(0,255,65,.5) 0px,transparent 1px,transparent 20px),
    repeating-linear-gradient(90deg,rgba(0,255,65,.5) 0px,transparent 1px,transparent 20px)
}
.radar-ring{
  position:absolute;
  inset:8%;
  border:1px solid rgba(0,255,65,.15);
  border-radius:50%
}
.radar-ring::before,.radar-ring::after{
  content:'';
  position:absolute;
  border-radius:50%;
  border:1px solid rgba(0,255,65,.1)
}
.radar-ring::before{inset:25%}.radar-ring::after{inset:50%;border-color:rgba(0,255,65,.08)}
.radar-cross{
  position:absolute;
  inset:0;
  background:
    linear-gradient(90deg,transparent calc(50% - .5px),rgba(0,255,65,.08) calc(50% - .5px),rgba(0,255,65,.08) calc(50% + .5px),transparent calc(50% + .5px)),
    linear-gradient(0deg,transparent calc(50% - .5px),rgba(0,255,65,.08) calc(50% - .5px),rgba(0,255,65,.08) calc(50% + .5px),transparent calc(50% + .5px))
}
.radar-canvas{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  z-index:5
}
.radar-dots{
  position:absolute;
  inset:0;
  z-index:10
}
.radar-dot{
  position:absolute;
  width:10px;
  height:10px;
  border-radius:50%;
  transform:translate(-50%,-50%);
  opacity:.4;
  transition:all .15s ease-out;
  will-change:transform,opacity
}
.radar-dot.active{
  opacity:1;
  transform:translate(-50%,-50%) scale(1.8);
  filter:brightness(1.5)
}
.radar-dot.purple{background:#b026ff;box-shadow:0 0 8px #b026ff}
.radar-dot.red{background:var(--war);box-shadow:0 0 8px var(--war)}
.radar-dot.ai{background:var(--aq);box-shadow:0 0 8px var(--aq)}
.radar-footer{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 16px 0;
  gap:12px
}
.radar-info{flex:1}
.radar-count{
  font-family:'Space Mono',monospace;
  font-size:32px;
  font-weight:700;
  color:var(--aq);
  line-height:1;
  text-shadow:0 0 15px rgba(0,255,65,.4);
  letter-spacing:-2px
}
.radar-sub{font-size:11px;color:var(--txs);margin-top:2px;font-weight:500}
.vibe-btn{
  background:var(--ap);
  color:#000;
  border:none;
  padding:14px 20px;
  font-size:13px;
  font-weight:700;
  letter-spacing:.3px;
  border-radius:10px;
  display:flex;
  align-items:center;
  gap:8px;
  flex-shrink:0;
  touch-action:manipulation;
  box-shadow:0 4px 0 rgba(255,61,0,.3);
  transform:translateY(0);
  transition:all .1s
}
.vibe-btn:active{
  transform:translateY(4px);
  box-shadow:0 0 0 rgba(255,61,0,.3)
}

/* FILTER SECTION */
.filter-sect{padding:16px;border-bottom:1px solid var(--bd)}
.filter-top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px
}
.filter-title{font-size:11px;font-weight:700;color:var(--txs);letter-spacing:.5px}
.match-pct{font-family:'Space Mono',monospace;font-size:14px;color:var(--ap);font-weight:700}
.slider-wrap{margin-bottom:12px}
.vibe-slider{
  width:100%;
  height:4px;
  background:var(--bd);
  border-radius:2px;
  outline:none;
  -webkit-appearance:none
}
.vibe-slider::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:24px;
  height:24px;
  background:var(--ap);
  border:3px solid var(--bg);
  border-radius:50%;
  box-shadow:0 0 0 1px var(--ap),0 2px 8px rgba(255,61,0,.4);
  margin-top:-10px
}
.vibe-slider::-webkit-slider-runnable-track{
  height:4px;
  background:linear-gradient(90deg,var(--ap) 0%,var(--ap) 87%,var(--bd) 87%);
  border-radius:2px
}
.slider-labels{
  display:flex;
  justify-content:space-between;
  font-size:9px;
  color:var(--txm);
  margin-top:6px;
  font-weight:600
}
.mood-scroll{
  display:flex;
  gap:8px;
  overflow-x:auto;
  padding-bottom:4px;
  margin:0 -16px;
  padding:0 16px 4px;
  scrollbar-width:none
}
.mood-scroll::-webkit-scrollbar{display:none}
.mood-chip{
  flex-shrink:0;
  padding:10px 16px;
  background:var(--sf);
  border:1px solid var(--bd);
  border-radius:24px;
  font-size:12px;
  font-weight:600;
  color:var(--txs);
  white-space:nowrap;
  touch-action:manipulation;
  transition:all .15s
}
.mood-chip.active{background:var(--ap);border-color:var(--ap);color:#000}
.mood-chip:active{transform:scale(.95);opacity:.8}

/* SPILLS */
.spills-sect{padding:16px;padding-bottom:calc(80px + var(--safe-bottom))}
.sect-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px
}
.sect-title{font-size:11px;font-weight:700;letter-spacing:.5px;color:var(--txs)}
.sect-meta{font-family:'Space Mono',monospace;font-size:9px;color:var(--txm)}
.spill-card{
  background:var(--sf);
  border:1px solid var(--bd);
  border-radius:16px;
  margin-bottom:12px;
  overflow:hidden
}
.spill-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:14px 16px;
  border-bottom:1px solid var(--bd);
  background:var(--bg)
}
.spill-user{
  font-family:'Space Mono',monospace;
  font-size:11px;
  color:var(--txs);
  font-weight:600
}
.spill-mood{
  font-size:10px;
  font-weight:700;
  padding:6px 12px;
  border-radius:20px;
  text-transform:uppercase;
  letter-spacing:.5px
}
.spill-mood.surviving{color:var(--ms);background:rgba(255,149,0,.1)}
.spill-mood.thriving{color:var(--mt);background:rgba(57,255,20,.1)}
.spill-mood.chaotic{color:var(--mc);background:rgba(0,240,255,.1)}
.spill-mood.doom{color:var(--md);background:rgba(139,92,246,.1)}
.spill-body{padding:16px;font-size:15px;line-height:1.6;color:var(--tx)}
.spill-actions{
  display:flex;
  gap:8px;
  padding:12px 16px;
  border-top:1px solid var(--bd);
  background:var(--bg);
  overflow-x:auto;
  scrollbar-width:none
}
.spill-actions::-webkit-scrollbar{display:none}
.react-btn{
  display:flex;
  align-items:center;
  gap:6px;
  padding:10px 16px;
  background:var(--sf);
  border:1px solid var(--bd);
  border-radius:24px;
  font-size:14px;
  color:var(--txs);
  flex-shrink:0;
  touch-action:manipulation;
  transition:all .15s
}
.react-btn.active{background:var(--ap);border-color:var(--ap);color:#000}
.react-btn:active{transform:scale(.95)}
.react-count{font-family:'Space Mono',monospace;font-size:12px;font-weight:700;min-width:18px}
.refresh-btn{
  width:100%;
  padding:16px;
  background:transparent;
  border:1px dashed var(--bd);
  border-radius:16px;
  color:var(--txs);
  font-size:13px;
  font-weight:600;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  margin-top:8px;
  touch-action:manipulation;
  transition:all .15s
}
.refresh-btn:active{background:var(--sf)}

/* BOTTOM NAV */
.bnav{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:rgba(0,0,0,.95);
  backdrop-filter:blur(20px);
  border-top:1px solid var(--bd);
  padding-bottom:var(--safe-bottom);
  z-index:100
}
.bnav-inner{
  display:flex;
  justify-content:space-around;
  align-items:center;
  height:60px;
  max-width:480px;
  margin:0 auto
}
.nav-item{
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:4px;
  height:100%;
  color:var(--txs);
  text-decoration:none;
  font-size:10px;
  font-weight:600;
  letter-spacing:.3px;
  position:relative;
  touch-action:manipulation;
  transition:all .15s
}
.nav-item.active{color:var(--ap)}
.nav-item.active::before{
  content:'';
  position:absolute;
  top:0;
  left:50%;
  transform:translateX(-50%);
  width:20px;
  height:2px;
  background:var(--ap);
  border-radius:0 0 2px 2px
}
.nav-icon{font-size:22px;line-height:1;margin-bottom:-2px}

/* MODALS */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:var(--bg);
  z-index:200;
  flex-direction:column;
  overflow:hidden
}
.modal.on{display:flex}
.modal-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:16px;
  border-bottom:1px solid var(--bd);
  padding-top:calc(16px + var(--safe-top))
}
.modal-title{font-size:17px;font-weight:700;letter-spacing:-.3px}
.modal-close{
  width:36px;
  height:36px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:var(--sf);
  border:1px solid var(--bd);
  border-radius:10px;
  color:var(--txs);
  font-size:18px;
  touch-action:manipulation;
  transition:all .15s
}
.modal-close:active{background:var(--bd)}
.modal-body{
  flex:1;
  overflow-y:auto;
  padding:20px 16px calc(20px + var(--safe-bottom));
  -webkit-overflow-scrolling:touch
}
.modal-tag{
  font-family:'Space Mono',monospace;
  font-size:10px;
  color:var(--ap);
  margin-bottom:8px;
  letter-spacing:1px;
  font-weight:700
}
.modal-h{font-size:26px;font-weight:800;margin-bottom:6px;letter-spacing:-.5px;line-height:1.2}
.modal-sub{font-size:14px;color:var(--txs);margin-bottom:28px;line-height:1.5}
.gender-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin-bottom:24px
}
.gender-card{
  background:var(--sf);
  border:1px solid var(--bd);
  border-radius:20px;
  padding:28px 16px;
  text-align:center;
  touch-action:manipulation;
  transition:all .15s
}
.gender-card.selected{border-color:var(--ap);background:rgba(255,61,0,.08)}
.gender-card:active{transform:scale(.96)}
.gender-icon{font-size:36px;margin-bottom:12px;display:block}
.gender-label{font-size:15px;font-weight:700;margin-bottom:4px}
.gender-desc{font-size:12px;color:var(--txs)}
.info-box{
  background:var(--sf);
  border-left:3px solid var(--ap);
  padding:16px;
  margin-bottom:28px;
  border-radius:0 16px 16px 0
}
.info-box p{font-family:'Space Mono',monospace;font-size:11px;color:var(--txs);line-height:1.7}
.info-box strong{color:var(--ap);font-weight:700}
.action-btn{
  width:100%;
  padding:18px;
  background:var(--ap);
  color:#000;
  border:none;
  border-radius:14px;
  font-size:15px;
  font-weight:700;
  letter-spacing:.3px;
  touch-action:manipulation;
  transition:all .15s
}
.action-btn:disabled{opacity:.3}
.action-btn:active{transform:scale(.98)}

/* CHAT ROOM */
.chat-room{
  display:none;
  position:fixed;
  inset:0;
  background:var(--bg);
  z-index:300;
  flex-direction:column
}
.chat-room.on{display:flex}
.chat-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 16px;
  padding-top:calc(12px + var(--safe-top));
  border-bottom:1px solid var(--bd);
  background:var(--sf)
}
.chat-info{flex:1}
.chat-label{font-family:'Space Mono',monospace;font-size:9px;color:var(--aq);letter-spacing:1px;margin-bottom:3px;font-weight:700}
.chat-name{font-size:15px;font-weight:700}
.chat-timer{
  font-family:'Space Mono',monospace;
  font-size:16px;
  font-weight:700;
  color:var(--aq);
  background:var(--bg);
  padding:8px 14px;
  border-radius:10px;
  border:1px solid var(--bd);
  letter-spacing:-1px
}
.chat-timer.warn{color:var(--war);border-color:var(--war);animation:blink 1s infinite;background:rgba(255,0,64,.1)}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.6}}
.chat-close{
  width:40px;
  height:40px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:var(--bg);
  border:1px solid var(--bd);
  border-radius:12px;
  color:var(--txs);
  margin-left:12px;
  font-size:18px;
  touch-action:manipulation;
  transition:all .15s
}
.chat-close:active{background:var(--bd)}
.chat-messages{
  flex:1;
  overflow-y:auto;
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:12px;
  -webkit-overflow-scrolling:touch
}
.chat-bubble{
  max-width:85%;
  padding:14px 18px;
  border-radius:20px;
  font-size:15px;
  line-height:1.5;
  word-wrap:break-word;
  animation:popIn .25s cubic-bezier(.175,.885,.32,1.275)
}
@keyframes popIn{from{opacity:0;transform:scale(.8) translateY(10px)}to{opacity:1;transform:scale(1) translateY(0)}}
.chat-bubble.me{
  align-self:flex-end;
  background:var(--ap);
  color:#000;
  border-bottom-right-radius:6px;
  font-weight:600
}
.chat-bubble.them{
  align-self:flex-start;
  background:var(--sf);
  border:1px solid var(--bd);
  border-bottom-left-radius:6px
}
.chat-time{
  font-size:10px;
  color:var(--txm);
  margin-top:6px;
  font-family:'Space Mono',monospace;
  font-weight:600
}
.typing{
  display:flex;
  gap:4px;
  padding:18px 22px;
  background:var(--sf);
  border:1px solid var(--bd);
  border-radius:20px;
  border-bottom-left-radius:6px;
  align-self:flex-start;
  width:fit-content
}
.typing-dot{width:8px;height:8px;background:var(--aq);border-radius:50%;animation:typing 1.4s infinite}
.typing-dot:nth-child(2){animation-delay:.2s}
.typing-dot:nth-child(3){animation-delay:.4s}
@keyframes typing{0%,60%,100%{transform:translateY(0)}30%{transform:translateY(-5px)}}
.distress{
  display:none;
  padding:14px 16px;
  background:var(--war);
  color:#fff;
  font-size:12px;
  font-weight:700;
  text-align:center;
  letter-spacing:.3px
}
.distress.show{display:block}
.chat-input-wrap{
  padding:12px 16px calc(12px + var(--safe-bottom));
  border-top:1px solid var(--bd);
  background:var(--sf);
  display:flex;
  gap:10px
}
.chat-input{
  flex:1;
  background:var(--bg);
  border:1px solid var(--bd);
  border-radius:24px;
  padding:14px 18px;
  font-size:15px;
  color:var(--tx);
  outline:none;
  -webkit-appearance:none;
  transition:all .15s
}
.chat-input:focus{border-color:var(--ap)}
.chat-send{
  width:48px;
  height:48px;
  background:var(--ap);
  border:none;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#000;
  font-size:20px;
  flex-shrink:0;
  touch-action:manipulation;
  transition:all .15s;
  box-shadow:0 4px 0 rgba(255,61,0,.3)
}
.chat-send:active{
  transform:translateY(4px);
  box-shadow:0 0 0 rgba(255,61,0,.3)
}

/* TOAST */
.toast{
  position:fixed;
  bottom:100px;
  left:50%;
  transform:translateX(-50%) translateY(100px);
  background:var(--tx);
  color:var(--bg);
  padding:14px 24px;
  border-radius:30px;
  font-size:14px;
  font-weight:700;
  z-index:400;
  opacity:0;
  transition:all .3s cubic-bezier(.175,.885,.32,1.275);
  pointer-events:none;
  white-space:nowrap;
  box-shadow:0 10px 40px rgba(0,0,0,.5)
}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.toast.error{background:var(--war);color:#fff}

/* PRICING */
.price-card{
  background:var(--sf);
  border:1px solid var(--bd);
  border-radius:20px;
  padding:24px 20px;
  margin-bottom:12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  touch-action:manipulation;
  transition:all .15s
}
.price-card.selected{border-color:var(--ap);background:rgba(255,61,0,.08)}
.price-card:active{transform:scale(.98)}
.price-main{font-size:32px;font-weight:800;color:var(--ap);letter-spacing:-2px;line-height:1}
.price-sub{font-size:12px;color:var(--txs);margin-top:4px;font-family:'Space Mono',monospace}
.price-right{text-align:right}
.price-tag{font-size:13px;font-weight:700;color:var(--aq);margin-bottom:3px}
.price-note{font-size:11px;color:var(--txm);font-family:'Space Mono',monospace}
.timer-big{
  text-align:center;
  padding:40px 24px;
  background:var(--sf);
  border-radius:20px;
  margin-bottom:24px;
  border:1px solid var(--bd)
}
.timer-big .num{
  font-family:'Space Mono',monospace;
  font-size:56px;
  font-weight:700;
  color:var(--war);
  line-height:1;
  letter-spacing:-3px
}
.timer-big .label{font-size:12px;color:var(--txs);margin-top:12px;text-transform:uppercase;letter-spacing:2px;font-weight:600}

/* EMPTY STATE */
.empty-state{text-align:center;padding:60px 20px}
.empty-icon{font-size:48px;margin-bottom:16px;opacity:.5}
.empty-title{font-size:16px;font-weight:700;color:var(--txs);margin-bottom:6px}
.empty-text{font-size:13px;color:var(--txm)}
</style>
</head>
<body>
<div class="app">

<!-- HEADER -->
<div class="header">
  <div class="logo">SP<span>‚úï</span>LL</div>
  <div class="status">
    <div class="pulse"></div>
    <span class="live">LIVE</span>
  </div>
</div>

<!-- MAIN SCROLL -->
<div class="scroll">

<!-- RADAR NATIVE -->
<div class="radar-sect">
  <div class="radar-header">
    <span class="radar-label">VIBE RADAR</span>
    <span class="radar-stat">ONLINE</span>
  </div>
  <div class="radar-wrapper">
    <div class="radar-cont" id="radarCont">
      <div class="radar-grid"></div>
      <div class="radar-ring"></div>
      <div class="radar-cross"></div>
      <canvas class="radar-canvas" id="radarCanvas"></canvas>
      <div class="radar-dots" id="radarDots"></div>
    </div>
  </div>
  <div class="radar-footer">
    <div class="radar-info">
      <div class="radar-count" id="quotaBadge">24</div>
      <div class="radar-sub">Online ‚Ä¢ Ready to match</div>
    </div>
    <button class="vibe-btn" onclick="startVibeCheck()">
      <span>‚¨°</span>
      <span>VIBE CHECK</span>
    </button>
  </div>
</div>

<!-- FILTER -->
<div class="filter-sect">
  <div class="filter-top">
    <span class="filter-title">KESELARASAN</span>
    <span class="match-pct" id="vibePct">87%</span>
  </div>
  <div class="slider-wrap">
    <input type="range" class="vibe-slider" id="vibeSlider" min="0" max="100" value="87" oninput="updateVibePct(this.value)">
    <div class="slider-labels"><span>Homie</span><span>Semi</span><span>All</span></div>
  </div>
  <div class="mood-scroll">
    <button class="mood-chip active" data-mood="all" onclick="filterMood(this)">Semua</button>
    <button class="mood-chip" data-mood="surviving" onclick="filterMood(this)">üòÆ‚Äçüí® Surviving</button>
    <button class="mood-chip" data-mood="thriving" onclick="filterMood(this)">‚ú® Thriving</button>
    <button class="mood-chip" data-mood="chaotic" onclick="filterMood(this)">üåÄ Chaotic</button>
    <button class="mood-chip" data-mood="doom" onclick="filterMood(this)">üõå Doom</button>
  </div>
</div>

<!-- SPILLS -->
<div class="spills-sect">
  <div class="sect-header">
    <span class="sect-title">SPILL TERKINI</span>
    <span class="sect-meta">FIFO</span>
  </div>
  <div id="spillsList"></div>
  <button class="refresh-btn" onclick="refreshSpills()">
    <span>‚Üª</span>
    <span>Seduh Teh Baru</span>
  </button>
</div>

</div><!-- /scroll -->

<!-- BOTTOM NAV -->
<nav class="bnav">
  <div class="bnav-inner">
    <a href="jejak.html" class="nav-item">
      <span class="nav-icon">‚ú¶</span>
      <span>Jejak</span>
    </a>
    <a href="spill.html" class="nav-item active">
      <span class="nav-icon">‚úï</span>
      <span>Spill</span>
    </a>
    <a href="cocomeo.html" class="nav-item">
      <span class="nav-icon">„Äú</span>
      <span>Cocomeo</span>
    </a>
    <a href="glitch.html" class="nav-item">
      <span class="nav-icon">‚ö°</span>
      <span>Glitch</span>
    </a>
  </div>
</nav>

</div><!-- /app -->

<!-- GENDER MODAL -->
<div class="modal" id="genderModal">
  <div class="modal-header">
    <span class="modal-title">Vibe Check</span>
    <button class="modal-close" onclick="closeModal('genderModal')">‚úï</button>
  </div>
  <div class="modal-body">
    <div class="modal-tag">INIT_SESSION</div>
    <div class="modal-h">Siapa Kamu?</div>
    <div class="modal-sub">Pilih identitasmu untuk matching lawan jenis</div>
    <div class="gender-grid">
      <div class="gender-card" onclick="selectGender('male')">
        <span class="gender-icon">‚ôÇ</span>
        <div class="gender-label">Pria</div>
        <div class="gender-desc">Match dengan wanita</div>
      </div>
      <div class="gender-card" onclick="selectGender('female')">
        <span class="gender-icon">‚ôÄ</span>
        <div class="gender-label">Wanita</div>
        <div class="gender-desc">Match dengan pria</div>
      </div>
    </div>
    <div class="info-box">
      <p><strong>>> GRATIS 15 MENIT</strong><br>Sesi berakhir otomatis. Chat FIFO 20 pesan. Tidak tersimpan.</p>
    </div>
    <button class="action-btn" id="genderConfirm" onclick="confirmGender()" disabled>Mulai Chat</button>
  </div>
</div>

<!-- UPGRADE MODAL -->
<div class="modal" id="upgradeModal">
  <div class="modal-header">
    <span class="modal-title">Waktu Habis</span>
    <button class="modal-close" onclick="closeModal('upgradeModal')">‚úï</button>
  </div>
  <div class="modal-body">
    <div class="timer-big">
      <div class="num">15:00</div>
      <div class="label">Sesi Gratis Selesai</div>
    </div>
    <div class="price-card" onclick="selectPlan('weekly')">
      <div>
        <div class="price-main">10K</div>
        <div class="price-sub">7 HARI ‚Ä¢ 2 JAM/HARI</div>
      </div>
      <div class="price-right">
        <div class="price-tag">14 JAM</div>
        <div class="price-note">@1.428/jam</div>
      </div>
    </div>
    <div class="price-card" onclick="selectPlan('monthly')">
      <div>
        <div class="price-main">50K</div>
        <div class="price-sub">30 HARI ‚Ä¢ 3 JAM/HARI</div>
      </div>
      <div class="price-right">
        <div class="price-tag">90 JAM</div>
        <div class="price-note">@555/jam</div>
      </div>
    </div>
    <div style="display:flex;gap:12px;margin-top:8px">
      <button class="action-btn" id="upgradeNow" onclick="upgradeNow()" disabled style="flex:1">Upgrade</button>
      <button class="action-btn" onclick="closeModal('upgradeModal')" style="flex:1;background:var(--sf);color:var(--tx)">Nanti</button>
    </div>
  </div>
</div>

<!-- CHAT ROOM -->
<div class="chat-room" id="chatRoom">
  <div class="chat-head">
    <div class="chat-info">
      <div class="chat-label">ANON CHAT // STRANGER</div>
      <div class="chat-name" id="chatPartnerName">Connecting...</div>
    </div>
    <div class="chat-timer" id="chatTimer">15:00</div>
    <button class="chat-close" onclick="closeChat()">‚úï</button>
  </div>
  <div class="chat-messages" id="chatMessages"></div>
  <div class="distress" id="distressBanner">Butuh bantuan? 119 ext 8 (Into The Light)</div>
  <div class="chat-input-wrap">
    <input type="text" class="chat-input" id="chatInput" placeholder="Ketik pesan..." maxlength="200">
    <button class="chat-send" onclick="sendMsg()">‚û§</button>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
// STATE
let currentGender=null,chatPartner=null,timerInterval=null,chatTimeLeft=900;
let selectedPlan=null,activeMood='all',radarInterval,userName='user',chatHistory=[];

const FEMALE_CHARS=['beby.manis','strawberry.shortcake','pretty.sad','little.fairy','cinnamon.girl'];
const MALE_CHARS=['si.badai','moon.child','si.kocak','si.pedas','abang.gaul'];

const USER_RANTS=[
  {id:1,author:'anon.kucing',mood:'surviving',content:'Hari ini gue nangis di angkot gegara liat kucing dipukul orang. Mental gue udah kayak kerupuk kena hujan.',reactions:{skull:42,cry:89,fire:12,upside:7}},
  {id:2,author:'sleepy.head',mood:'thriving',content:'akhirnya bisa tidur nyenyak semalaman setelah 3 minggu insomnia. makasih buat yang chat tadi malem.',reactions:{skull:23,cry:15,fire:67,upside:31}},
  {id:3,author:'chaos.queen',mood:'chaotic',content:'hari ini chaos abis! dari bangun tidur udah salah ambil kaki, sampe kantor lupa bawa laptop.',reactions:{skull:89,cry:23,fire:45,upside:78}},
  {id:4,author:'quiet.one',mood:'doom',content:'udah seminggu nggak keluar kamar. bukan karena sibuk. cuma nggak tau mau ngapain.',reactions:{skull:67,cry:112,fire:8,upside:34}}
];

const REACTION_EMOJI={skull:'üíÄ',cry:'üò≠',fire:'üî•',upside:'üôÉ'};
const $=id=>document.getElementById(id);
const esc=t=>{const d=document.createElement('div');d.textContent=t;return d.innerHTML};

function toast(msg,isErr=false){
  const t=$('toast');
  t.textContent=msg;
  t.className='toast'+(isErr?' error':'');
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),2500);
}

function closeModal(id){$(id).classList.remove('on');}
function updateVibePct(val){$('vibePct').textContent=val+'%';}

function filterMood(btn){
  document.querySelectorAll('.mood-chip').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  activeMood=btn.dataset.mood;
  renderSpills();
}

// SPILLS
function renderSpills(){
  const list=$('spillsList');
  const filtered=activeMood==='all'?USER_RANTS:USER_RANTS.filter(s=>s.mood===activeMood);
  
  if(!filtered.length){
    list.innerHTML='<div class="empty-state"><div class="empty-icon">üçÉ</div><div class="empty-title">Belum ada spill</div><div class="empty-text">Coba filter lain</div></div>';
    return;
  }
  
  list.innerHTML=filtered.map(s=>`
    <div class="spill-card">
      <div class="spill-head">
        <span class="spill-user">@${esc(s.author)}</span>
        <span class="spill-mood ${s.mood}">${s.mood}</span>
      </div>
      <div class="spill-body">${esc(s.content)}</div>
      <div class="spill-actions">
        ${Object.entries(REACTION_EMOJI).map(([k,em])=>`
          <button class="react-btn ${s.userReacted===k?'active':''}" onclick="react(this,${s.id},'${k}')">
            <span>${em}</span>
            <span class="react-count" id="rc-${s.id}-${k}">${s.reactions[k]}</span>
          </button>
        `).join('')}
      </div>
    </div>
  `).join('');
}

function react(btn,id,key){
  const spill=USER_RANTS.find(s=>s.id===id);
  if(!spill)return;
  const wasActive=btn.classList.contains('active');
  document.querySelectorAll(`#rc-${id}-${key}`).forEach(el=>{
    el.closest('.react-btn').classList.remove('active');
  });
  if(!wasActive){
    btn.classList.add('active');
    spill.reactions[key]++;
    spill.userReacted=key;
  }else{
    spill.reactions[key]--;
    spill.userReacted=null;
  }
  Object.keys(spill.reactions).forEach(k=>{
    const el=$(`rc-${id}-${k}`);
    if(el)el.textContent=spill.reactions[k];
  });
}

function refreshSpills(){renderSpills();toast('Teh baru diseduh ‚òï');}

// RADAR - NATIVE MOBILE
let radarDots=[],radarAngle=0,radarRAF=null;
const SWEEP_SPEED=Math.PI*2/(3*60);

function initRadar(){
  const canvas=$('radarCanvas');
  const cont=$('radarCont');
  
  function resize(){
    const rect=cont.getBoundingClientRect();
    canvas.width=rect.width;
    canvas.height=rect.height;
  }
  
  resize();
  window.addEventListener('resize',resize,{passive:true});
  
  spawnDots();
  
  // Update dots position periodically
  radarInterval=setInterval(()=>{
    radarDots.forEach(d=>{
      d.x=Math.max(8,Math.min(92,d.x+(Math.random()-.5)*2));
      d.y=Math.max(8,Math.min(92,d.y+(Math.random()-.5)*2));
      d.el.style.left=d.x+'%';
      d.el.style.top=d.y+'%';
    });
  },3500);
  
  $('quotaBadge').textContent=Math.floor(18+Math.random()*15);
  radarLoop(canvas);
}

function spawnDots(){
  const con=$('radarDots');
  con.innerHTML='';
  radarDots=[];
  const count=5+Math.floor(Math.random()*4);
  
  for(let i=0;i<count+2;i++){
    const isAI=i>=count;
    const angle=Math.random()*Math.PI*2;
    const radius=20+Math.random()*60;
    const x=50+Math.cos(angle)*radius/2;
    const y=50+Math.sin(angle)*radius/2;
    
    const dot=document.createElement('div');
    const type=isAI?'ai':(Math.random()>.5?'purple':'red');
    dot.className=`radar-dot ${type}`;
    dot.style.left=x+'%';
    dot.style.top=y+'%';
    con.appendChild(dot);
    
    radarDots.push({el:dot,x,y,type});
  }
}

function radarLoop(canvas){
  const ctx=canvas.getContext('2d');
  const centerX=canvas.width/2;
  const centerY=canvas.height/2;
  const radius=Math.min(centerX,centerY)*0.85;
  
  function frame(){
    radarAngle=(radarAngle+SWEEP_SPEED)%(Math.PI*2);
    
    // Fade effect
    ctx.fillStyle='rgba(0,0,0,0.15)';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    
    // Draw sweep
    ctx.save();
    ctx.translate(centerX,centerY);
    ctx.rotate(radarAngle);
    
    const gradient=ctx.createLinearGradient(0,0,radius,0);
    gradient.addColorStop(0,'rgba(0,255,65,0.8)');
    gradient.addColorStop(0.3,'rgba(0,255,65,0.3)');
    gradient.addColorStop(1,'rgba(0,255,65,0)');
    
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.arc(0,0,radius,-0.3,0.3);
    ctx.closePath();
    ctx.fillStyle=gradient;
    ctx.fill();
    
    ctx.restore();
    
    // Check collisions
    radarDots.forEach(d=>{
      const dotX=d.x/100*canvas.width;
      const dotY=d.y/100*canvas.height;
      const dx=dotX-centerX;
      const dy=dotY-centerY;
      let angle=Math.atan2(dy,dx);
      if(angle<0)angle+=Math.PI*2;
      
      let diff=radarAngle-angle;
      if(diff<0)diff+=Math.PI*2;
      if(diff>Math.PI)diff=Math.PI*2-diff;
      
      if(diff<0.15){
        d.el.classList.add('active');
        setTimeout(()=>d.el.classList.remove('active'),400);
      }
    });
    
    radarRAF=requestAnimationFrame(frame);
  }
  
  radarRAF=requestAnimationFrame(frame);
}

// VIBE CHECK
function startVibeCheck(){$('genderModal').classList.add('on');}

function selectGender(g){
  document.querySelectorAll('.gender-card').forEach(c=>c.classList.remove('selected'));
  event.currentTarget.classList.add('selected');
  currentGender=g;
  $('genderConfirm').disabled=false;
}

function confirmGender(){
  if(!currentGender)return;
  closeModal('genderModal');
  const n=prompt('Nama panggilan:','user');
  if(n?.trim())userName=n.trim();
  startChat();
}

// CHAT
async function startChat(){
  chatHistory=[];
  $('chatMessages').innerHTML='';
  $('distressBanner').classList.remove('show');
  $('chatRoom').classList.add('on');
  chatTimeLeft=900;
  startTimer();
  
  const opp=currentGender==='male'?'female':'male';
  const charList=opp==='female'?FEMALE_CHARS:MALE_CHARS;
  const randomName=charList[Math.floor(Math.random()*charList.length)];
  
  chatPartner={name:randomName,gender:opp};
  $('chatPartnerName').textContent='STRANGER_'+String(Math.floor(Math.random()*99)).padStart(2,'0');
  
  setTimeout(()=>addMsg('Halo! Ada cerita apa hari ini? üëã',false),1000);
}

function addMsg(text,isOwn){
  const div=document.createElement('div');
  div.className='chat-bubble '+(isOwn?'me':'them');
  const time=new Date().toLocaleTimeString('id-ID',{hour:'2-digit',minute:'2-digit'});
  div.innerHTML=esc(text)+`<div class="chat-time">${time}</div>`;
  $('chatMessages').appendChild(div);
  $('chatMessages').scrollTop=$('chatMessages').scrollHeight;
  
  while($('chatMessages').children.length>20){
    $('chatMessages').removeChild($('chatMessages').firstChild);
  }
}

function showTyping(){
  const div=document.createElement('div');
  div.className='typing';
  div.id='typing';
  div.innerHTML='<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
  $('chatMessages').appendChild(div);
  $('chatMessages').scrollTop=$('chatMessages').scrollHeight;
  return div;
}

async function sendMsg(){
  const inp=$('chatInput');
  const text=inp.value.trim();
  if(!text)return;
  
  addMsg(text,true);
  inp.value='';
  
  const typing=showTyping();
  
  setTimeout(()=>{
    typing.remove();
    const replies=['Hmm... interesting','Ooh gitu ya','Ngerti feelsnya üòî','Same bestie','Relate banget!','Waduh...','Haha same energy','ü´Ç'];
    addMsg(replies[Math.floor(Math.random()*replies.length)],false);
  },1200+Math.random()*1500);
}

function startTimer(){
  updateTimer();
  timerInterval=setInterval(()=>{
    chatTimeLeft--;
    updateTimer();
    if(chatTimeLeft===300)toast('‚ö†Ô∏è Sisa 5 menit!');
    if(chatTimeLeft<=0)endChat();
  },1000);
}

function updateTimer(){
  const m=Math.floor(chatTimeLeft/60);
  const s=chatTimeLeft%60;
  $('chatTimer').textContent=`${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  $('chatTimer').classList.toggle('warn',chatTimeLeft<=300);
}

function endChat(){
  clearInterval(timerInterval);
  timerInterval=null;
  $('chatRoom').classList.remove('on');
  $('upgradeModal').classList.add('on');
}

function closeChat(){
  clearInterval(timerInterval);
  timerInterval=null;
  $('chatRoom').classList.remove('on');
  toast('Sampai jumpa! üëã');
}

function selectPlan(plan){
  document.querySelectorAll('.price-card').forEach(c=>c.classList.remove('selected'));
  event.currentTarget.classList.add('selected');
  selectedPlan=plan;
  $('upgradeNow').disabled=false;
}

function upgradeNow(){
  if(!selectedPlan)return;
  toast('Processing...');
  setTimeout(()=>{
    toast('Upgrade berhasil! ‚úÖ');
    closeModal('upgradeModal');
    chatTimeLeft=selectedPlan==='weekly'?7200:10800;
    $('chatRoom').classList.add('on');
    clearInterval(timerInterval);
    startTimer();
    addMsg('Sesi dilanjutkan!',false);
  },1000);
}

// INIT
document.addEventListener('DOMContentLoaded',()=>{
  initRadar();
  renderSpills();
  $('chatInput').addEventListener('keydown',e=>{
    if(e.key==='Enter')sendMsg();
  });
});
</script>
</body>
</html>
