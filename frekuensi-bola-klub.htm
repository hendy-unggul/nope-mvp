<!DOCTYPE html>
<html lang="id" data-theme="glitch">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NOPE ‚Äî Detail Klub</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23ff9999'/%3E%3Ctext x='50' y='70' font-size='60' font-weight='bold' font-family='system-ui' text-anchor='middle' fill='%23000'%3ENO%3C/text%3E%3C/svg%3E">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,500;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="frekuensi-shared.css">
  <style>
    .klub-full { max-width: 1200px; margin: 0 auto; padding: 20px; }
    
    /* KLUB INFO HEADER */
    .klub-header { background: var(--surface-elevated); border: 1px solid var(--border); border-radius: 20px; padding: 30px; margin-bottom: 30px; }
    .klub-top { display: flex; justify-content: space-between; align-items: start; margin-bottom: 24px; flex-wrap: wrap; gap: 20px; }
    .klub-identity { }
    .klub-name { font-size: 32px; font-weight: 800; margin-bottom: 8px; }
    .klub-liga { display: inline-block; background: var(--accent); color: white; padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; }
    .klub-logo { width: 80px; height: 80px; background: var(--surface); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 40px; }
    
    .klub-details { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
    .detail-item { }
    .detail-label { font-size: 12px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 6px; }
    .detail-value { font-size: 16px; font-weight: 600; }
    
    /* ATHLETES TABLE */
    .athletes-section { background: var(--surface-elevated); border: 1px solid var(--border); border-radius: 20px; padding: 24px; }
    .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 12px; }
    .section-title { font-size: 20px; font-weight: 700; }
    .athlete-count { background: var(--surface); padding: 6px 14px; border-radius: 20px; font-size: 13px; color: var(--muted); }
    
    .athletes-table { width: 100%; border-collapse: collapse; }
    .athletes-table th { text-align: left; padding: 14px 16px; font-size: 12px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid var(--border); font-weight: 600; }
    .athletes-table td { padding: 16px; border-bottom: 1px solid var(--border); }
    .athletes-table tr:hover { background: rgba(178, 102, 255, 0.05); }
    .athletes-table tr { cursor: pointer; transition: all 0.2s; }
    
    .athlete-info { display: flex; align-items: center; gap: 12px; }
    .athlete-avatar { width: 40px; height: 40px; border-radius: 50%; background: var(--accent); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 14px; }
    .athlete-name { font-weight: 600; }
    .athlete-username { font-size: 13px; color: var(--muted); }
    
    .position-badge { display: inline-block; padding: 6px 14px; border-radius: 20px; font-size: 13px; font-weight: 600; background: rgba(178, 102, 255, 0.15); color: var(--accent); }
    .position-badge.GK { background: rgba(255, 193, 7, 0.15); color: #ffc107; }
    .position-badge.DF { background: rgba(33, 150, 243, 0.15); color: #2196f3; }
    .position-badge.MF { background: rgba(76, 175, 80, 0.15); color: #4caf50; }
    .position-badge.FW { background: rgba(244, 67, 54, 0.15); color: #f44336; }
    
    .psiko-badge { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
    .psiko-badge.done { background: rgba(0, 200, 83, 0.15); color: #00c853; }
    .psiko-badge.pending { background: rgba(158, 158, 158, 0.15); color: #9e9e9e; }
    
    /* MODAL */
    .modal-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 2000; justify-content: center; align-items: center; padding: 20px; }
    .modal-overlay.active { display: flex; }
    .modal-content { background: var(--surface); border: 1px solid var(--border); border-radius: 24px; max-width: 900px; width: 100%; max-height: 90vh; overflow-y: auto; position: relative; }
    .modal-close { position: absolute; top: 20px; right: 20px; width: 40px; height: 40px; border-radius: 50%; background: var(--surface-elevated); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 20px; color: var(--muted); }
    .modal-close:hover { background: var(--accent); color: white; }
    
    .modal-header { padding: 30px; border-bottom: 1px solid var(--border); }
    .modal-athlete { display: flex; align-items: center; gap: 20px; }
    .modal-avatar { width: 80px; height: 80px; border-radius: 50%; background: var(--accent); display: flex; align-items: center; justify-content: center; font-size: 32px; font-weight: 700; }
    .modal-info { }
    .modal-name { font-size: 28px; font-weight: 700; margin-bottom: 8px; }
    .modal-meta { display: flex; gap: 16px; flex-wrap: wrap; }
    .meta-item { font-size: 14px; color: var(--muted); }
    .meta-item strong { color: var(--text); }
    
    .modal-body { padding: 30px; }
    
    /* BIG FIVE RESULTS */
    .big-five-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 16px; margin-bottom: 30px; }
    @media (max-width: 768px) { .big-five-grid { grid-template-columns: repeat(2, 1fr); } }
    .dimension-mini { text-align: center; padding: 20px; background: var(--surface-elevated); border-radius: 16px; border: 2px solid var(--border); }
    .dimension-mini.high { border-color: var(--accent); }
    .dim-icon { font-size: 28px; margin-bottom: 8px; }
    .dim-name { font-size: 12px; font-weight: 600; text-transform: uppercase; margin-bottom: 4px; }
    .dim-score { font-size: 24px; font-weight: 800; color: var(--accent); }
    
    /* STRENGTHS */
    .strengths-box { background: var(--surface-elevated); border-radius: 16px; padding: 24px; margin-bottom: 30px; }
    .strengths-title { font-size: 16px; font-weight: 600; margin-bottom: 16px; }
    .strength-chips { display: flex; flex-wrap: wrap; gap: 10px; }
    .strength-chip { background: var(--accent); color: white; padding: 10px 20px; border-radius: 24px; font-size: 14px; font-weight: 600; }
    
    /* HEATMAP */
    .heatmap-section { margin-top: 30px; }
    .heatmap-title { font-size: 18px; font-weight: 700; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
    .heatmap-container { display: grid; grid-template-columns: 120px 1fr; gap: 20px; align-items: start; }
    .heatmap-labels { display: flex; flex-direction: column; gap: 8px; }
    .heatmap-label { height: 40px; display: flex; align-items: center; font-size: 13px; color: var(--muted); }
    .heatmap-grid { display: grid; grid-template-columns: repeat(10, 1fr); gap: 4px; }
    .heatmap-cell { aspect-ratio: 1; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700; color: white; }
    .heatmap-cell.low { background: #37474f; }
    .heatmap-cell.med { background: #546e7a; }
    .heatmap-cell.high { background: var(--accent); }
    .heatmap-legend { display: flex; gap: 20px; margin-top: 16px; justify-content: center; }
    .legend-item { display: flex; align-items: center; gap: 8px; font-size: 12px; color: var(--muted); }
    .legend-color { width: 16px; height: 16px; border-radius: 4px; }
    
    .back-link { color: var(--muted); text-decoration: none; font-size: 14px; margin-bottom: 20px; display: inline-flex; align-items: center; gap: 6px; }
    .back-link:hover { color: var(--accent); }
  </style>
</head>
<body>
  <div class="wrapper">
    <header>
      <div class="logo" onclick="window.location.href='index.html'">NOPE</div>
      <div class="top-right">
        <div class="nav-mini">
          <span onclick="window.location.href='jejak.html'">Jurnal</span>
          <span class="active">Frekuensi</span>
          <span onclick="window.location.href='saynope.html'">SayNOPE</span>
          <span onclick="window.location.href='glitch.html'">GLITCH</span>
        </div>
        <button class="settings-btn" id="settings-btn">‚ãØ</button>
      </div>
    </header>

    <div class="klub-full">
      <a href="frekuensi-bola-database.html" class="back-link">‚Üê Kembali ke Database</a>
      
      <!-- KLUB INFO -->
      <div class="klub-header">
        <div class="klub-top">
          <div class="klub-identity">
            <h1 class="klub-name" id="klub-nama">Persija Jakarta U15</h1>
            <span class="klub-liga" id="klub-liga">LIGA U15</span>
          </div>
          <div class="klub-logo">üèüÔ∏è</div>
        </div>
        
        <div class="klub-details">
          <div class="detail-item">
            <div class="detail-label">Pelatih Kepala</div>
            <div class="detail-value" id="klub-pelatih">Coach Ahmad Yani</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Alamat</div>
            <div class="detail-value" id="klub-alamat">Stadion Patriot, Bekasi</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Telepon</div>
            <div class="detail-value" id="klub-telepon">0812-3456-7890</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Jumlah Atlet</div>
            <div class="detail-value">20 Pemain</div>
          </div>
        </div>
      </div>

      <!-- ATHLETES LIST -->
      <div class="athletes-section">
        <div class="section-header">
          <h2 class="section-title">Daftar Atlet</h2>
          <span class="athlete-count">20 Pemain</span>
        </div>
        
        <table class="athletes-table">
          <thead>
            <tr>
              <th>Nama Atlet</th>
              <th>Posisi</th>
              <th>Umur</th>
              <th>Tinggi</th>
              <th>Psikometrik</th>
            </tr>
          </thead>
          <tbody id="athletes-tbody">
            <!-- Generated by JS -->
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- MODAL PSikometrik -->
  <div class="modal-overlay" id="modal-psikometrik">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal()">√ó</button>
      
      <div class="modal-header">
        <div class="modal-athlete">
          <div class="modal-avatar" id="modal-avatar">F</div>
          <div class="modal-info">
            <div class="modal-name" id="modal-nama">Fajar Hidayat</div>
            <div class="modal-meta">
              <span class="meta-item">üìç <strong id="modal-posisi">Gelandang</strong></span>
              <span class="meta-item">üéÇ <strong id="modal-umur">14 tahun</strong></span>
              <span class="meta-item">üìè <strong id="modal-tinggi">165 cm</strong></span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-body">
        <!-- Big Five -->
        <div class="big-five-grid" id="modal-bigfive">
          <!-- Generated by JS -->
        </div>
        
        <!-- Strengths -->
        <div class="strengths-box">
          <div class="strengths-title">üèÜ Profil Keistimewaan</div>
          <div class="strength-chips" id="modal-strengths">
            <!-- Generated by JS -->
          </div>
        </div>
        
        <!-- Heatmap -->
        <div class="heatmap-section">
          <div class="heatmap-title">üî• Heatmap Karakter Permainan</div>
          <div class="heatmap-container">
            <div class="heatmap-labels">
              <div class="heatmap-label">Kreativitas</div>
              <div class="heatmap-label">Disiplin</div>
              <div class="heatmap-label">Leadership</div>
              <div class="heatmap-label">Kerja Sama</div>
              <div class="heatmap-label">Ketenangan</div>
            </div>
            <div class="heatmap-grid" id="heatmap-grid">
              <!-- Generated by JS -->
            </div>
          </div>
          <div class="heatmap-legend">
            <div class="legend-item"><div class="legend-color" style="background: #37474f;"></div> Rendah</div>
            <div class="legend-item"><div class="legend-color" style="background: #546e7a;"></div> Sedang</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--accent);"></div> Tinggi</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="frekuensi-shared.js"></script>
  <script>
    // Parse URL params
    const urlParams = new URLSearchParams(window.location.search);
    const klubId = urlParams.get('id') || 'persija-u15';

    // Database klub
    const klubData = {
      'persija-u15': { nama: 'Persija Jakarta U15', liga: 'U15', pelatih: 'Coach Ahmad Yani', alamat: 'Stadion Patriot, Bekasi', telepon: '0812-3456-7890' },
      'villa-u15': { nama: 'Villa U15', liga: 'U15', pelatih: 'Coach Budi Santoso', alamat: 'Lapangan Villa, Depok', telepon: '0813-4567-8901' },
      'persija-u17': { nama: 'Persija Jakarta U17', liga: 'U17', pelatih: 'Coach Eko Purwanto', alamat: 'Stadion Patriot, Bekasi', telepon: '0812-3456-7891' },
      'villa-u17': { nama: 'Villa U17', liga: 'U17', pelatih: 'Coach Fajar Hidayat', alamat: 'Lapangan Villa, Depok', telepon: '0813-4567-8902' }
    };

    // Generate 20 mock athletes
    function generateAthletes(klubId) {
      const positions = ['GK', 'DF', 'MF', 'FW'];
      const posWeights = [2, 6, 7, 5]; // 2 keeper, 6 bek, 7 midfield, 5 forward
      const athletes = [];
      let id = 1;
      
      positions.forEach((pos, idx) => {
        for (let i = 0; i < posWeights[idx]; i++) {
          const hasPsiko = Math.random() > 0.3; // 70% sudah tes
          athletes.push({
            id: id,
            nama: `Atlet ${klubId.split('-')[0]} ${String.fromCharCode(65 + id - 1)}`,
            username: `@${klubId.replace('-', '_')}_${id.toString().padStart(3, '0')}`,
            posisi: pos,
            umur: klubId.includes('u15') ? 13 + Math.floor(Math.random() * 3) : 16 + Math.floor(Math.random() * 2),
            tinggi: 155 + Math.floor(Math.random() * 25),
            psikometrik: hasPsiko,
            scores: hasPsiko ? {
              O: 40 + Math.floor(Math.random() * 50),
              C: 40 + Math.floor(Math.random() * 50),
              E: 40 + Math.floor(Math.random() * 50),
              A: 40 + Math.floor(Math.random() * 50),
              N: 40 + Math.floor(Math.random() * 50)
            } : null
          });
          id++;
        }
      });
      
      return athletes.sort((a, b) => positions.indexOf(a.posisi) - positions.indexOf(b.posisi));
    }

    // Render klub info
    const klub = klubData[klubId] || klubData['persija-u15'];
    document.getElementById('klub-nama').textContent = klub.nama;
    document.getElementById('klub-liga').textContent = `LIGA ${klub.liga}`;
    document.getElementById('klub-pelatih').textContent = klub.pelatih;
    document.getElementById('klub-alamat').textContent = klub.alamat;
    document.getElementById('klub-telepon').textContent = klub.telepon;

    // Render athletes
    const athletes = generateAthletes(klubId);
    const tbody = document.getElementById('athletes-tbody');
    
    tbody.innerHTML = athletes.map(a => `
      <tr onclick="openModal(${a.id})">
        <td>
          <div class="athlete-info">
            <div class="athlete-avatar">${a.nama.charAt(0)}</div>
            <div>
              <div class="athlete-name">${a.nama}</div>
              <div class="athlete-username">${a.username}</div>
            </div>
          </div>
        </td>
        <td><span class="position-badge ${a.posisi}">${a.posisi}</span></td>
        <td>${a.umur} th</td>
        <td>${a.tinggi} cm</td>
        <td>
          ${a.psikometrik 
            ? '<span class="psiko-badge done">‚úì Tervalidasi</span>' 
            : '<span class="psiko-badge pending">‚óã Belum Tes</span>'}
        </td>
      </tr>
    `).join('');

    // Modal functions
    function openModal(athleteId) {
      const athlete = athletes.find(a => a.id === athleteId);
      if (!athlete || !athlete.psikometrik) {
        alert('Atlet belum melakukan tes psikometrik');
        return;
      }
      
      document.getElementById('modal-avatar').textContent = athlete.nama.charAt(0);
      document.getElementById('modal-nama').textContent = athlete.nama;
      document.getElementById('modal-posisi').textContent = 
        athlete.posisi === 'GK' ? 'Kiper' : 
        athlete.posisi === 'DF' ? 'Bek' : 
        athlete.posisi === 'MF' ? 'Gelandang' : 'Penyerang';
      document.getElementById('modal-umur').textContent = athlete.umur + ' tahun';
      document.getElementById('modal-tinggi').textContent = athlete.tinggi + ' cm';
      
      // Big Five
      const dimensions = [
        { key: 'O', name: 'Openness', icon: 'üé®' },
        { key: 'C', name: 'Conscientiousness', icon: 'üìã' },
        { key: 'E', name: 'Extraversion', icon: '‚ö°' },
        { key: 'A', name: 'Agreeableness', icon: 'ü§ù' },
        { key: 'N', name: 'Stability', icon: 'üßò' }
      ];
      
      document.getElementById('modal-bigfive').innerHTML = dimensions.map(d => `
        <div class="dimension-mini ${athlete.scores[d.key] >= 60 ? 'high' : ''}">
          <div class="dim-icon">${d.icon}</div>
          <div class="dim-name">${d.name}</div>
          <div class="dim-score">${athlete.scores[d.key]}%</div>
        </div>
      `).join('');
      
      // Strengths
      const strengths = calculateStrengths(athlete.scores);
      document.getElementById('modal-strengths').innerHTML = strengths.map(s => 
        `<span class="strength-chip">${s}</span>`
      ).join('');
      
      // Heatmap
      renderHeatmap(athlete.scores);
      
      document.getElementById('modal-psikometrik').classList.add('active');
    }

    function closeModal() {
      document.getElementById('modal-psikometrik').classList.remove('active');
    }

    function calculateStrengths(scores) {
      const s = [];
      if (scores.O >= 65) s.push('üé® Kreatif');
      if (scores.C >= 65) s.push('üí™ Disiplin');
      if (scores.E >= 65) s.push('‚ö° Energik');
      if (scores.A >= 65) s.push('ü§ù Team Player');
      if (scores.N >= 65) s.push('üßò Tenang');
      if (scores.C >= 60 && scores.N >= 60) s.push('üéØ Clutch');
      if (scores.O >= 60 && scores.E >= 60) s.push('üî• Playmaker');
      if (scores.E >= 60 && scores.A >= 60) s.push('üëë Leader');
      return s.slice(0, 3);
    }

    function renderHeatmap(scores) {
      const grid = document.getElementById('heatmap-grid');
      const dims = ['O', 'C', 'E', 'A', 'N'];
      
      let html = '';
      dims.forEach(dim => {
        const score = scores[dim];
        for (let i = 0; i < 10; i++) {
          const cellScore = (i + 1) * 10;
          const isActive = score >= cellScore;
          const intensity = isActive ? (score >= 70 ? 'high' : score >= 40 ? 'med' : 'low') : 'low';
          html += `<div class="heatmap-cell ${intensity}">${isActive ? '‚óè' : ''}</div>`;
        }
      });
      
      grid.innerHTML = html;
    }

    // Close modal on outside click
    document.getElementById('modal-psikometrik').addEventListener('click', function(e) {
      if (e.target === this) closeModal();
    });
  </script>
</body>
</html>
